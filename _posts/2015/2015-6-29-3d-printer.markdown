---
layout: post
title:  "3D打印机Reprap Prusa Mendel i3"
date:   2015-6-29 14:40:00
---

##缘起
作为一个白菜党，买过不少便宜的路由器。这些路由器性能还行，只是外壳太大，天线夸张。于是想到为什么不自己打印一个呢？就和网件那样方方正正的就好了。
Reprap是开源的打印机，软件硬件全部开源。而且看上去Maker味十足。本来准备到reprappro官网买的，后来发现taobao上已经有很多了。于是直接买了个山寨的。

[<img src="http://fkpwolf.net/images/2015/3dprinter.jpg" width="300px"/>][1]

##安装
开源+山寨，没有个图文并茂的手册，安装起来太费劲。不过一番鼓捣之后，对整个机器的机构倒是了解的很透彻了。所谓3D打印，是指一个可以XYZ三轴运动的打印头。
X、Y轴靠皮带轮运动，和老式拖拉机的皮带类似。Z轴运动幅度小，靠两根螺杆上下微调。
XYZ三维空间有个原点，有了原点才有其他的坐标系。这个每个轴的原点是靠一个微动开关来感应的，就和鼠标微动一样，当打印头”点击“微动时，机器就知道了这个原点的位置。

除了XYZ的马达，打印头也有马达，用来把材料卷入打印喷嘴。

驱动板我用的是Melzi，大概等于“Arduino+RAMPS+StepStick”。RAMPS是连接/接口板，StepStick是马达驱动板。主控么，都是Atmel系的。
这个组合是很多Maker推荐的，优点在于哪里坏了换哪里，价格也更便宜。

##打印
Repetier Host能够把3D模型切成打印机的一个个指令。除了分层，切片软件还考虑了材料的受力情况。比如边缘用一圈一圈打印，里面用平行线打印。比如每层件平行线的
方向不同，这样成品更结实。当遇到悬空的地方，切片软件还能自动生成支撑件。这个计算量还是蛮考研CPU的。可惜这个软件基于.NET，linux跑起来下面还蛮折腾。

整个过程分工明确：计算机软件负责3D建模和”解模“，而单片机控制的马达负责简单重复的机械运动。驱动板Melzi用的是ATMEGA1284P，属于8位机AVR系列，
性能没法和ARM SOC的相比较，却依然能让整个系统各司其职、有条不紊的运行。很是奇妙。

##3D建模
Repetier-Host接受的文件是STL格式，SketchUp安装插件后可以导出这种格式。不过导入STL好像会丢失信息，比如圆会变成由多根直线连接而模拟出来的圆。
模型共享站点也都用的STL格式，这样你只能打印，没法修改了。这种非Open Source的方式不利于3D打印的发展。

##蓝牙连接
按照这里的来http://reprap.org/wiki/Melzi#Connect_via_Bluetooth。蓝牙模块买taobao上面叫“HC-06”的那种，CSR芯片。
先在PC上面配置好，然后找个常用的开发板比如bpi，蓝牙模块连接bpi，PC匹配蓝牙模块，测试两者串口是否能正常工作。最后再连接到Melzi板子上去。
不过调试起来有些兼容性问题，我用黑苹果的蓝牙，Windows下面，打印每隔一段时间会停顿，console有“resend...checksum error”的错误提示。
换成Intel AC7260就很稳定了。可能是黑苹果有些驱动或者5G信号干扰的问题。
有的主控版（http://reprap.org/wiki/Duet）带以太网接口，这个可能会更加稳定和方便，不过价格就贵了很多。
[<img src="http://fkpwolf.net/images/2015/Melzi-bluetooth.jpg" width="300px"/>][2]
用了一段时间，还是不稳定。安装了LCD后，换成用SD卡打印。

##LCD
taobao上买了个最便宜的，50￥。打印虎的，需要刷机。本来不想刷机的，怕又得重新配置。后来发现这个过程其实不麻烦。
是我想太多了，年纪大了，小小变化也要长考半天。
这个LCD模块最好的功能是可以“暂停-继续”，这样就可以完全脱离PC运行了。AVR打印的同时还可以驱动屏幕菜单，神奇。

##后面
打印了一个banana pi的盒子，拿在手里把玩，确实感觉神奇。宅男自己在家里不用taobao也能做出能够用的东西。

[1]:http://fkpwolf.net/images/2015/3dprinter.jpg
[2]:http://fkpwolf.net/images/2015/Melzi-bluetooth.jpg